{% extends "base.html" %}
{% load static %}

{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col">

        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="store-content container-flex bg-dark-green">
    <div class="store-row row">
        <h2 class="page-title font-color-dark col-12">Native Trees and Seeds</h2>
    </div>
    <div class="store-row row">
        <div class="display-options col-12 row">
            <form method="GET" action="{% url 'products' %}">
                <label for="product-filter">Filter By:</label>
                <select onchange="this.form.submit()" class="product-filter-select" name="product-filter" id="product-filter">
                    <option value="all" {% if current_category == None %} selected {% endif %}>All Products</option>
                    <option value="seeds" {% if current_category == 'seeds' %} selected {% endif %}>Seeds</option>
                    <option value="sapling_2_litre_pot" {% if current_category == 'sapling_2_litre_pot' %} selected {% endif %}>Saplings 2L Pot</option>
                    <option value="sapling_4_litre_pot" {% if current_category == 'sapling_4_litre_pot' %} selected {% endif %}>Saplings 4L Pot</option>
                    <option value="sapling_10_litre_pot" {% if current_category == 'sapling_10_litre_pot' %} selected {% endif %}>Saplings 10L Pot</option>
                </select>
                <label for="product-sort">Sort By:</label>
                <select onchange="this.form.submit()" class="product-sort-select" name="product-sort" id="product-sort">
                    <option value="price_asc" {% if current_sorting == 'price_asc' or current_sorting == None %} selected {% endif %}>Price Ascending</option>
                    <option value="price_desc" {% if current_sorting == 'price_desc' %} selected {% endif %}>Price Descending</option>
                    {% if current_category == None %} 
                        <option value="category" {% if current_sorting == 'category' %} selected {% endif %}>Category</option>
                    {% endif %}
                </select>
                <input type="text" placeholder="Search Keyword" name="q" {% if search_term %}value="{{ search_term }}"{% endif %}>
                <button type='submit'>Search</button>
            </form>
        </div>
        <div class="results-found col-12">
            <p class="font-color-dark">{% if search_term %}{{ search_term }} - {% endif %}{% if current_category == None %}All Categories{% else %}{{ category_friendly.friendly_name }}{% endif %} - {{ sort_friendly }} | {{ products|length }} Items Found <a href="{% url 'products' %}">Clear Search</a></p>
        </div>
    <div class="store-row">
    <div class="products-container">
        {% if products|length >= 1 %}
            {% for product in products %}
                <div class="product-card row no-gutters">
                    {% if product.image %}
                        <a class="product-card-image col-12" href="">
                            <img src="{{ product.image.url }}" alt="">
                        </a>
                    {% endif %}
                    <div class="card-title col-12 row">
                        <div class="col-12 row">
                            <p class="product-name col-8">{{ product.product_name }}</p>
                            <p class="product-price col-4">â‚¬{{ product.price }}</p>
                        </div>
                        <div class="product-card-options col-12 row">
                            <form action="{% url 'add_to_basket' product.id %}" method="POST" class="form">
                                {% csrf_token %}
                                <input type="number" class="form-control" name="quantity" value="1" min="1" max="99" data-item-id="{{ product.id}}" id="id_qty_{{ product.id }}">
                                <button class="col-6" type="submit">Add to Basket</button>
                                <button class="col-6">View Product</button>
                            </form>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
        {% endif %}
    </div>
    </div>
    </div>
</div>
{% endblock %}